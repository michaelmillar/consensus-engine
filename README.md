Roll your own consensus engine